var VGCalendar=function(){"use strict";function t(t,e,n,r){return new(n||(n=Promise))(function(o,a){function i(t){try{c(r.next(t))}catch(t){a(t)}}function s(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(i,s)}c((r=r.apply(t,e||[])).next())})}function e(){try{const t="__test";return sessionStorage.setItem(t,"1"),sessionStorage.removeItem(t),!0}catch(t){return!1}}function n(n){return t(this,void 0,void 0,function*(){const t=function(t){if(e()){const e=sessionStorage.getItem(t);if(e)try{const t=JSON.parse(e);if(!t.exp||t.exp>Date.now())return t.value}catch(t){return null}}return null}(n);if(t)return t;const r=yield fetch(n),o=yield r.json();return function(t,n,r=3e5){if(e()){const e={value:n,exp:Date.now()+r};try{sessionStorage.setItem(t,JSON.stringify(e))}catch(t){}}}(n,o,3e5),o})}function r(t,e){t.setAttribute("aria-pressed",e?"true":"false")}function o(t,e){const n=document.getElementById(t);n&&(n.textContent=e)}function a(t,e){(function(){const t=document.createElement("input");t.setAttribute("type","date");const e="not-a-date";return t.setAttribute("value",e),t.value!==e})()&&(t.startDate.type="date",t.endDate.type="date"),t.typeButtons.forEach(n=>{n.addEventListener("click",()=>{t.typeButtons.forEach(t=>r(t,!1)),n.classList.add("active"),r(n,!0),e()}),n.addEventListener("keydown",t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),n.click())})});const n=function(t,e){let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>t(...r),e)}}(e,300);[t.startDate,t.endDate,t.searchBar,t.monthFilter,t.townFilter].forEach(t=>{t.addEventListener("change",n),t.addEventListener("input",n)}),t.resetBtn.addEventListener("click",()=>{t.startDate.value="",t.endDate.value="",t.searchBar.value="",t.monthFilter.value="",t.townFilter.value="",t.typeButtons.forEach(t=>{t.classList.remove("active"),r(t,!1)}),e()})}"function"==typeof SuppressedError&&SuppressedError;let i=null;class s{constructor(t){this.currentPage=1,this.totalPages=1,this.config=t,document.addEventListener("DOMContentLoaded",()=>this.init())}init(){var t,e;a({startDate:document.getElementById("start-date"),endDate:document.getElementById("end-date"),searchBar:document.getElementById("search-bar"),monthFilter:document.getElementById("month-filter"),townFilter:document.getElementById("town-filter"),typeButtons:document.querySelectorAll("#post-type-filters .post-type-filter"),resetBtn:document.getElementById("reset-filters")},()=>{this.currentPage=1,this.load()}),null===(t=document.getElementById("prev-page"))||void 0===t||t.addEventListener("click",()=>{this.currentPage>1&&(this.currentPage--,this.load())}),null===(e=document.getElementById("next-page"))||void 0===e||e.addEventListener("click",()=>{this.currentPage<this.totalPages&&(this.currentPage++,this.load())}),this.load()}load(){return t(this,void 0,void 0,function*(){const t=document.querySelector("#post-type-filters .post-type-filter.active"),e=new URLSearchParams({post_types:this.config.post_types.join(","),selected_post_type:t&&t.dataset.postType||"",start_date:document.getElementById("start-date").value,end_date:document.getElementById("end-date").value,search:document.getElementById("search-bar").value,month:document.getElementById("month-filter").value,town:document.getElementById("town-filter").value,template_id:String(this.config.template_id),paged:String(this.currentPage),_wpnonce:this.config.nonce,prefetch_next:"1"}),r=`${this.config.rest_url}?${e.toString()}`,a=yield n(r),s=document.getElementById("elementor-loop-content");if(s&&(s.innerHTML=a.content||""),this.totalPages=a.total_pages||1,this.currentPage=a.current_page||1,function(t,e){const n=document.getElementById("page-info"),r=document.getElementById("prev-page"),a=document.getElementById("next-page");n&&(n.textContent=`${t} / ${e}`),r&&(r.disabled=1===t),a&&(a.disabled=t===e),o("vg-aria-announcer",`${t} of ${e}`)}(this.currentPage,this.totalPages),a.next_page){!function(t){i||(i=document.createElement("link"),i.rel="prefetch",document.head.appendChild(i)),i.href=t}(`${this.config.rest_url}?paged=${this.currentPage+1}`)}if(o("vg-aria-announcer",`${a.schema?a.schema.length:0} events`),this.config.debug&&a.debug){const t=document.getElementById("vg-events-debug");t&&(t.classList.add("active"),t.textContent=JSON.stringify(a.debug,null,2))}})}}function c(){window.vgEvents&&new s(window.vgEvents)}return c(),c}();
